name: Refresh Featured Artist

on: 
    workflow_dispatch: # Manually trigger workflow, for testing
    schedule: 
        - cron: '0 0 * * *' # Run daily at midnight, based on server time

jobs:
    update-readme:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Set up Node.js
              uses: actions/setup-node@v4
              with:
                node-version: '20'

            - name: Refresh featured artist
              run: node refresh-featured-artist.js
              
            - name: Commit and push changes
              env: 
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              run: |
                git config --global user.name 'kevinweejh'
                git config --global user.email 'hello@codebykevin.dev'
                git add README.md
                git commit -m "chore: refresh daily featured artist"
                git push https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/kevinweejh/kevinweejh.git HEAD:issue-1-fix